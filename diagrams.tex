\documentclass{article}
\usepackage{thesiscommands}
\usepackage{makecell}
\usepackage{setspace}

\begin{document}

% Newton's Method - High Level 
{\Huge Newton's Method - High Level}\\

\begin{tikzpicture}[node distance=4cm]

  \node (init)   [input, draw] {Input: $p \in \reals[x]$, $z \in \reals$, $\epsilon \in \reals$};
  \node (comp)   [compute, draw, below of=init]   {$z = z - \frac{p(z)}{p'(z)}$};
  \node (check)  [branch, draw, below of=comp]    {$|p(x)| - \epsilon < 0$};
  \node (output) [accept, draw, below of=check]   {Output $z$};
  
  \draw [->, thick] (init) --                                      (comp);
  \draw [->, thick] (comp) --                                      (check);
  \draw [->, thick] (check) to [out=0, in=0] node[auto, swap] {No} (comp);
  \draw [->, thick] (check) to node[auto] {Yes}                    (output);

\end{tikzpicture}

\newpage

% Newton's Method - Lower Level

Newton Machine for 5th-degree polynomials over $\reals$ considered as
an ordered field.  $\inspace_M = \statespace_M = \reals^8$.
$\outspace_M = \reals$ The coordinate $x_1$ represents our current
point $z$, $x_2$ represents $\epsilon$, and the rest of the
coordinates represent the coefficients of the polynomial. In the
computation node, we compute $z = \frac{p(x)}{p'(x)}$, and we branch
on the condition $x_0^2 < \epsilon^2$, which is equivalent to $|x_0| <
\epsilon$.

\begin{figure}[p]
  \centering
  
  \begin{tikzpicture}[node distance=4cm, label distance=.5cm]

    \node(init) [input, draw, label=left:\Large $\eta_1$] {Input: $x = (x_1, x_2, x_3, x_4, x_5, x_6, x_7, x_8)$;};
    \node(comp) [compute, draw, label=left:\Large $\eta_2$, below of=init] {
      $g(x) = (x_1 - 
      \frac{x_3x_1^5 + x_4x_1^4+ x_5x_1^3 + x_6x_1^2 + x_7x_1 + x_8}
      {5x_3x_1^4 + 4x_4x_1^3 + 3x_5x_1^2 + 2x_6x_1 + x_7}, 
      x_2, x_3, x_4, x_5, x_6, x_7, x_8)$};
    \node(check)[branch, draw, label=left:\Large $\eta_3$, below of=comp] {$h(x) = x_1^2 - x_2^2$};
    \node(output)[accept, draw, label=left:\Large $\nodeout$,below of=check] {Output: $O(x) = x_0$};

    \draw [->, thick] (init) --                                             (comp);
    \draw [->, thick] (comp) --                                            (check);
    \draw [->, thick] (check) to [out=0, in=0] node[auto, swap] {$h(x) > 0$}(comp);
    \draw [->, thick] (check) to node[auto] {$h(x) < 0$}                  (output);

    \node (legend) [rectangle, draw, fill=black!10, right of=output, node distance=6cm] {
      \makecell[l]{
        $\nodes = \set{\eta_1, \eta_2, \eta_3, \nodeout}$\\
        $\inspace_M = \statespace_M = \outspace_M = \reals^8$\\
        Computation Nodes: $\set{\eta_2}$\\
        Branch Nodes: $\set{\eta_3}$
      }
    };
    
  \end{tikzpicture}

  \caption{Newton Machine - Low Level}
  \label{fig:newton-low}
\end{figure}

\newpage
\centering
\begin{tikzpicture}[node distance=4.8cm]

  \node(init) [input, draw, label=left:\Large $\eta_1$] 
  {Input: x = $(x_1, x_2, x_3)$};
  \node(test) [branch, draw, below of=init, label=45:\Large $\eta_2$] 
  {$h(x) = x_1 - \frac{x_2}{x_3}$};
  \node(flip) [compute, draw, left of=test, label=left:\Large $\eta_3$,]
  {$g(x)= (x_1, 1, x_2+1)$};
  \node(fliptest) [branch, draw, below of=flip, label=left:\Large $\eta_4$] 
  {$h(x) = x_3$};
  \node(inc)  [compute, draw, below of=fliptest, label=left:\Large $\eta_5$,] 
  {$g(x) = (x_1, x_2+1, x_3-1)$};
  \node(output)   [accept, draw, below of=test, right of=test, label=left:\Large $\nodeout$] 
  {Output: $O(x) = (x_2, x_3)$};

  \draw[->, thick] (init) -- (test);
  \draw[->, thick] (flip) -- (test);
  \draw[->, thick] (test) to [out=270, in=0] node [auto] {$h(x) \neq 0$} (inc);
  \draw[->, thick] (test) to [out=0, in=90] node[auto] {$h(x)=0$} (output);
  \draw[->, thick] (fliptest) to [out=0, in= 225] node[auto] {$h(x) = 0$} (test);
  \draw[->, thick] (fliptest) to [out=90, in= 270] node[auto] {$h(x) \neq 0$}(flip);
  \draw[->, thick] (inc) -- (fliptest);

  \node (legend) [rectangle, draw, fill=black!10, below of=output] {
    \makecell[l]{
      $\nodes = \set{\eta_1, \eta_2, \eta_3, \eta_4, \eta_5, \nodeout}$\\
      $\inspace_M = \reals, \statespace_M = \reals^3, \outspace_M = \reals^2$\\
      Computation Nodes: $\set{\eta_3, \eta_5}$\\
      Branch Nodes: $\set{\eta_2, \eta_4}$\\
      $\halting_M = \rationals^+$\\
      $\computefn_M(x) = (p,q) \mid x = \frac{p}{q}$
    }
  };

\end{tikzpicture}




\end{document}

